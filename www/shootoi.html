<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8"/>
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>ShootPi</title>
   <link rel="stylesheet" href="shootpi.css" type="text/css" />
<script>
   var hold='';

   function loadXMLDoc(){
      var xmlhttp;
      if (window.XMLHttpRequest){
         // code for IE7+, Firefox, Chrome, Opera, Safari
         xmlhttp=new XMLHttpRequest();
      }else{
         // code for IE6, IE5
         xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
      //Put the most recent image name in the variable 'hold'
      xmlhttp.onreadystatechange=function(){
         if (xmlhttp.readyState==4 && xmlhttp.status==200){
            hold=xmlhttp.responseText;
         }
      }
      //Get the latest info from 'ajax_info.txt'
      xmlhttp.open("GET","ajax_info.txt",true);
      xmlhttp.send();
      //Refresh the image only if it has a new name
      if(document.getElementById("myDiv").innerHTML!=hold){
         document.getElementById("myDiv2").innerHTML="<img src="+hold+">";
         document.getElementById("myDiv").innerHTML=hold;
      }
   }

   function shootStill(){
      var xmlhttp;
      if (window.XMLHttpRequest){
         // code for IE7+, Firefox, Chrome, Opera, Safari
         xmlhttp=new XMLHttpRequest();
      }else{
         // code for IE6, IE5
         xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
      xmlhttp.onreadystatechange=function(){
         if (xmlhttp.readyState==4 && xmlhttp.status==200){
            //Do something
         }
      }
      //Take a still image
      xmlhttp.open("GET","shootStill.php",true);
      xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
      xmlhttp.send();
   }

   function shootTimelapse(){
      var xmlhttp;
      if (window.XMLHttpRequest){
         // code for IE7+, Firefox, Chrome, Opera, Safari
         xmlhttp=new XMLHttpRequest();
      }else{
         // code for IE6, IE5
         xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
      xmlhttp.onreadystatechange=function(){
         if (xmlhttp.readyState==4 && xmlhttp.status==200){
            //Do something
         }
      }
      //Take a timelapse sequence
      xmlhttp.open("GET","shootTimelapse.php",true);
      xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
      xmlhttp.send();
   }

   function shootVideo(){
      var xmlhttp;
      if (window.XMLHttpRequest){
         // code for IE7+, Firefox, Chrome, Opera, Safari
         xmlhttp=new XMLHttpRequest();
      }else{
         // code for IE6, IE5
         xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
      xmlhttp.onreadystatechange=function(){
         if (xmlhttp.readyState==4 && xmlhttp.status==200){
            //Do something
         }
      }
      //Take a video
      xmlhttp.open("GET","shootVideo.php",true);
      xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
      xmlhttp.send();
   }

   function timedRefresh(timeoutPeriod) {
      loadXMLDoc();
      setTimeout("timedRefresh(1000);",timeoutPeriod);
   }
</script>
</head>
<!-- Set the refresh interval in miliseconds, default=1000 (1 second) -->
<body onload="JavaScript:timedRefresh(1000);">
   <div id="myDiv2"></div>
   <div id="myDiv"></div>
   <input type="button" value="Shoot Still" onClick='shootStill();'><br><br>
   <input type="button" value="Shoot Timelapse" onClick='shootTimelapse();'><br><br>
   <input type="button" value="Shoot Video" onClick='shootVideo();'><br><br>
</body>
</html>

